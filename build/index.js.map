{"version":3,"sources":["webpack:///webpack/bootstrap bac871c0660224c85e90","webpack:///./app/script/api.js","webpack:///./app/script/date.js","webpack:///./app/script/localStorage.js","webpack:///./app/script/location.js","webpack:///./app/styles/style.less","webpack:///./app/index.js"],"names":[],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;AChEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oEAAoE,SAAS;AAC7E,KAAK;AACL,sEAAsE,aAAa,OAAO,aAAa;AACvG;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,2DAA2D,WAAW,KAAK,eAAe;AAC1F;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,sEAAsE,SAAS;AAC/E,QAAQ;AACR,wEAAwE,aAAa,OAAO,aAAa;AACzG;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,oBAAoB;AACpB,uEAAuE,YAAY;AACnF;AACA;AACA,gBAAgB;AAChB,QAAQ;AACR,I;;;;;;;;AClDA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB,mBAAmB,GAAG,oBAAoB,GAAG,eAAe;;AAErF;AACA;AACA;AACA;AACA,qBAAqB,gBAAgB,KAAK,kBAAkB;AAC5D;AACA;AACA;AACA;AACA;;AAEA,4CAA4C,gCAAgC;AAC5E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,YAAY,GAAG,MAAM,GAAG,IAAI;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6CAA6C,gCAAgC;AAC7E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,E;;;;;;;;ACzDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;ACfA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,aAAa;AACb,KAAK;AACL,C;;;;;;AC3BA,yC;;;;;;;;;;;;;;ACAA;AACA;AACsB;AACH;AACE;AACA;;AAErB;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;;AAEA,kBAAkB,4BAA4B;AAC9C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA,CAAC;;AAED;AACA;AACA,CAAC","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bac871c0660224c85e90","\"use strict\";\r\n\r\nexport function apiRequest(settings) {\r\n    let url;\r\n    //if user accept share his coordinates - use request by coordinates\r\n    //if denided, suggest to user search by city name\r\n    if(typeof settings === \"string\"){\r\n        url = `https://api.openweathermap.org/data/2.5/forecast?q=${settings}&APPID=447928fbfad655830ae35b93c34bbedb`\r\n    }else{\r\n        url = `https://api.openweathermap.org/data/2.5/forecast?lat=${settings.lat}&lon=${settings.lon}&APPID=447928fbfad655830ae35b93c34bbedb` ;\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n\r\n        let xhr = new XMLHttpRequest();\r\n\r\n        xhr.open(\"GET\", url, false);\r\n        xhr.send();\r\n\r\n        if( xhr.status != 200 ){\r\n            alert(`Error! Cant get response from server! ${xhr.status} - ${xhr.statusText}`);\r\n            reject();\r\n        }else{\r\n            let data = JSON.parse(xhr.responseText);\r\n            resolve(data);\r\n        }\r\n    })\r\n}\r\n\r\n// export function apiRequest(settings) {\r\n//     let url;\r\n//     //if user accept share his coordinates - use request by coordinates\r\n//     //if denided, suggest to user search by city name\r\n//     if(typeof settings === \"string\"){\r\n//         url = `http://api.openweathermap.org/data/2.5/forecast?q=${settings}&APPID=447928fbfad655830ae35b93c34bbedb`\r\n//     }else{\r\n//         url = `http://api.openweathermap.org/data/2.5/forecast?lat=${settings.lat}&lon=${settings.lon}&APPID=447928fbfad655830ae35b93c34bbedb` ;\r\n//     }\r\n//     return new Promise((resolve, reject) => {\r\n//         $.getJSON(url, function (data) {\r\n//             resolve(data);\r\n//         })\r\n//             .fail(function (data) {\r\n//                 if(data.status == 404){\r\n//                     alert(\"404 Not found your city\")\r\n//                 }else{\r\n//                     alert(`Cant access to server. Request status: ${data.status}.`)\r\n//                 }\r\n//                 reject();\r\n//             });\r\n//     })\r\n// }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/script/api.js\n// module id = 0\n// module chunks = 0","\"use strict\";\r\n\r\nexport let forecast_day = new NextDays();\r\n//class for working with date, I try to create universal methods for reuse this code\r\n//methods in this class can give you all current day info with full names of month and day weeks\r\n// next days info from current date, name of month,\r\n//name of day weeks and dates\r\nfunction NextDays() {\r\n    \r\n    let days_of_week = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\r\n    let month = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\r\n        \"October\", \"November\", \"December\"];\r\n    let date = new Date();\r\n    let current_day = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`;\r\n\r\n    this.current_day_info = {\r\n            day_of_week: days_of_week[date.getDay()],\r\n            month: month[date.getMonth()],\r\n            number_day: date.getDate(),\r\n            time: `${date.getHours()} : ${date.getMinutes()}`\r\n    };\r\n    //get array with next X days from current day\r\n    this.getDateNextDays = (quantity_days_for_forecast) => {\r\n        let date_now = current_day.split(\"-\");\r\n        let result = [];\r\n        \r\n        for(let i = +date_now[2] + 1, j = 0; j < quantity_days_for_forecast; j++, i++ ){\r\n            let day = i;\r\n            let month = date_now[1];\r\n            \r\n            if(day > date.daysInMonth()){\r\n                day = 1;\r\n                month = (+month + 1) + \"\";\r\n            }\r\n            //in result I need dates in format \"2017-04-05\" for next search in api response\r\n            if(9 >= month)month = \"0\" + month;\r\n            if(9 >= day)day = \"0\" + day;\r\n            let data = `${date_now[0]}-${month}-${day}`;\r\n            result.push(data);\r\n        }\r\n        return result;\r\n    };\r\n    //get array with names of days in week\r\n    this.getNextNamesDayOfWeek = (quantity_days_for_forecast) => {\r\n        let result = [];\r\n        \r\n        for(let i = date.getDay() + 1, j = 0; j < quantity_days_for_forecast; i++, j++ ){\r\n            if(i > days_of_week.length - 1) i = 0;\r\n            result.push(days_of_week[i])\r\n        }\r\n        return result;\r\n    };\r\n}\r\n\r\n//custom method for get quantity days in current month\r\nDate.prototype.daysInMonth = function() {\r\n    return 32 - new Date(this.getFullYear(), this.getMonth(), 32).getDate();\r\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/script/date.js\n// module id = 1\n// module chunks = 0","\"use strict\";\r\nexport let localStorage = new Storage();\r\n//class for working with session storage, including method for add, get and check info from storage\r\nfunction Storage() {\r\n\r\n    this.getDataFromLocalStorage = (key) =>{\r\n        return JSON.parse(sessionStorage.getItem(key));\r\n    };\r\n    this.setDataToLocalStorage = (key, value) => {\r\n        let data = JSON.stringify(value);\r\n        sessionStorage.setItem(key, data);\r\n    };\r\n    this.isDataInStorage = (key) => {\r\n        return sessionStorage.getItem(key) != null\r\n    }\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/script/localStorage.js\n// module id = 2\n// module chunks = 0","\"use strict\";\r\n\r\nexport function getGeoLocation() {\r\n    return new Promise((resolve, reject) => {\r\n        navigator.geolocation.getCurrentPosition((position) => {\r\n            let coordinates = {};\r\n            coordinates.lat = position.coords.latitude;\r\n            coordinates.lon = position.coords.longitude;\r\n            \r\n            resolve(coordinates);\r\n            \r\n        }, (error) => {\r\n            switch(error.code) {\r\n                case 0: reject(new Error(\"UNKNOWN_ERROR\"));\r\n                    break;\r\n                case 1: reject(new Error(\"PERMISSION DENIED\"));\r\n                    break;\r\n                case 2: reject(new Error(\"POSITION UNAVAILABLE\"));\r\n                    break;\r\n                case 3: reject(new Error(\"TIMEOUT\"));\r\n                    break;\r\n            }\r\n        }, {\r\n            timeout: 5000,\r\n            maximumAge: 600000\r\n            });\r\n    })\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/script/location.js\n// module id = 3\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/styles/style.less\n// module id = 4\n// module chunks = 0","\"use strict\";\r\nimport \"./styles/style.less\";\r\nimport{getGeoLocation} from \"./script/location\";\r\nimport {apiRequest} from \"./script/api\";\r\nimport {forecast_day} from \"./script/date\";\r\nimport {localStorage} from \"./script/localStorage\";\r\n\r\nconst QUANTITY_DAYS_FORECAST = 4;\r\nlet nextWeekDays = forecast_day.getNextNamesDayOfWeek(QUANTITY_DAYS_FORECAST);\r\n\r\ngetGeoLocation()\r\n    .then(\r\n        resolve => {\r\n            return apiRequest(resolve);\r\n        },\r\n        reject => {\r\n            alert(`${reject}! Cant resolve your position. Try to enter your city`);\r\n            return reject();\r\n        }\r\n    )\r\n    .then(\r\n        resolve => {\r\n            handleDataForecast(resolve);\r\n            addTemplateToHtml(resolve);\r\n            setDeleteEvent();\r\n            localStorage.setDataToLocalStorage(resolve.city.name, resolve);\r\n        },\r\n        reject => {}\r\n    );\r\n\r\n$(\"#form\").on(\"submit\", function (event) {\r\n    let city = this.elements.city.value;\r\n\r\n    if( localStorage.isDataInStorage(city) ){\r\n        let data = localStorage.getDataFromLocalStorage(city);\r\n        addTemplateToHtml(data);\r\n        setDeleteEvent();\r\n        \r\n    }else{\r\n        \r\n        apiRequest(city)\r\n            .then(\r\n                resolve => {\r\n                    handleDataForecast(resolve);\r\n                    addTemplateToHtml(resolve);\r\n                    //after each new api request I save data to session storage, then if user search this city again\r\n                    //before request I check in storage is this city available\r\n                    localStorage.setDataToLocalStorage(city, resolve);\r\n                    setDeleteEvent();\r\n                },\r\n                reject => {}\r\n            )\r\n    }\r\n   event.preventDefault();\r\n});\r\n\r\n//add to forecast object info about current day and search forecast on next 4 days\r\nfunction handleDataForecast (data) {\r\n    let indexOfNextDays = searchIndexofNextDaysForecast(forecast_day.getDateNextDays(QUANTITY_DAYS_FORECAST), data);\r\n    transformKelvinToCelsius(data, 0);\r\n\r\n    data.next_days = [];\r\n    data.current_day_info = forecast_day.current_day_info;\r\n\r\n    for(let i = 0; i < QUANTITY_DAYS_FORECAST; i++){\r\n        data.next_days.push({\r\n            weekDay: nextWeekDays[i],\r\n            temp: data.list[indexOfNextDays[i]].main.temp,\r\n            image: data.list[indexOfNextDays[i]].weather[0].icon\r\n        })\r\n    }\r\n}\r\n\r\n//after each append template to html, I need set handle for delete block\r\nfunction setDeleteEvent() {\r\n    $(\".delete_button\").on(\"click\", (e)=>{\r\n        e.target.parentElement.remove();\r\n    });\r\n}\r\n\r\n//work with handlebars\r\nfunction addTemplateToHtml(data) {\r\n    let htmlTemp = $(\"#template\").html();\r\n    let template = Handlebars.compile(htmlTemp);\r\n    let result = template(data);\r\n    $(\"#main\").append(result);\r\n}\r\n\r\n//for next days forecast I choose time 15:00 for get temperature,I search necessary to me date and save\r\n//index to array, than I use that index in handlebars template\r\nfunction searchIndexofNextDaysForecast(dateArray, data) {\r\n    let arr = [];\r\n    let result = [];\r\n\r\n    dateArray.forEach((item, index) => {\r\n        arr[index] = item + \" 15:00:00\";\r\n    });\r\n\r\n    data.list.forEach((item, index) => {\r\n\r\n        arr.forEach((arg) => {\r\n\r\n            if(arg === item.dt_txt){\r\n                result.push(index);\r\n                transformKelvinToCelsius(data, index);\r\n            }\r\n        })\r\n    });\r\n    return result;\r\n}\r\n\r\nfunction transformKelvinToCelsius(data, index) {\r\n    if(parseInt(data.list[index].main.temp - 273.15, 10 ) > 0){\r\n        data.list[index].main.temp = \"+\" + parseInt(data.list[index].main.temp - 273.15, 10 )\r\n    }else{\r\n        data.list[index].main.temp = parseInt(data.list[index].main.temp - 273.15, 10)\r\n    }\r\n}\r\n\r\n//helper function for add to template next days forecast with loops\r\nHandlebars.registerHelper(\"week_day\", function () {\r\n    return Handlebars.escapeExpression(this.weekDay) + \"\";\r\n});\r\n\r\nHandlebars.registerHelper(\"icon\", function () {\r\n    return Handlebars.escapeExpression(this.image) + \"\";\r\n});\r\n\r\nHandlebars.registerHelper(\"temp\", function () {\r\n    return Handlebars.escapeExpression(this.temp) + \"\";\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/index.js\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}